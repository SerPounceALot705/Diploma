!function(e){var t={};function a(s){if(t[s])return t[s].exports;var r=t[s]={i:s,l:!1,exports:{}};return e[s].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=t,a.d=function(e,t,s){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(s,r,function(t){return e[t]}.bind(null,r));return s},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=9)}([function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));class s{constructor(){}static setData(e,t){localStorage.setItem(e,JSON.stringify(t))}static getData(e){return JSON.parse(localStorage.getItem(e))}static deleteData(e){localStorage.removeItem(e)}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));class s{constructor(){}static setDate(e){const t=new Date;return new Date(t.setDate(t.getDate()+e))}static removeChild(e){for(;e.hasChildNodes();)e.removeChild(e.firstChild)}static sliceString(e){return e.slice(0,e.length-3)}static insertSubString(e,t,a){return t.slice(0,e)+a+t.slice(e)}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return r}));const s="7798f9c937f249c594a87e4725d25525",r="https://api.github.com/repos/serpouncealot705/diploma/commits?page=1&per_page=20"},function(e,t,a){},function(e,t,a){"use strict";a.r(t),t.default=a.p+"images/not-img.png"},function(e,t,a){"use strict";a.r(t),t.default=a.p+"images/Ellipse.png"},function(e,t,a){"use strict";a.r(t),t.default=a.p+"images/not-found_v1.png"},,,function(e,t,a){"use strict";a.r(t);a(3);var s=a(1),r=a(0);class n{constructor(){}static render(e,t){e.forEach(e=>{const r=class{constructor(){}static create(e){const t=document.createElement("div");t.classList.add("card");const r='\n            <img class=card-image src="" alt="фото новости">\n            <div class="card-info">\n                <div class="data"></div>\n                <h2 class="card-title"></h2>\n                <p class="card-text">}</p>\n                <a href="" class="card-link" target="_blank"></a>\n            </div>';t.insertAdjacentHTML("beforeend",r.trim());let n=new Date(e.publishedAt).toLocaleDateString("ru-RU",{year:"numeric",month:"long",day:"numeric"});return n=s.a.sliceString(n),n=s.a.insertSubString(n.length-5,n,", "),t.querySelector(".card-image").src=null==e.urlToImage||""==e.urlToImage?a(4).default:e.urlToImage,t.querySelector(".card-title").textContent=(window.innerWidth,e.title),t.querySelector(".card-text").textContent=e.description,t.querySelector(".card-link").textContent=e.source.name,t.querySelector(".card-link").href=e.url,t.querySelector(".data").textContent=n,t}}.create(e);t.appendChild(r)})}}class i{constructor(){}static applyLoader(e){s.a.removeChild(e);const t='\n            <img class="search-box__loading" src="" alt="прелоудер сайта">\n            <h2 class="search-box__message">Идет поиск новостей...</h2>';e.insertAdjacentHTML("beforeend",t.trim()),e.querySelector(".search-box__loading").src=a(5).default,e.style.minHeight="282px"}static applyBadResult(e,t,r){s.a.removeChild(e);const n='\n            <img class="search-box__result" src="" alt="результаты поиска по запросу">\n            <p class="search-box__report"></p>\n            <h2 class="search-box__message"></h2>';e.insertAdjacentHTML("beforeend",n.trim()),document.querySelector(".search-box__report").textContent=t,document.querySelector(".search-box__message").textContent=r,e.querySelector(".search-box__result").src=a(6).default}static applyHeaderCards(e){s.a.removeChild(e);const t='\n            <div class="searching-results">\n                <div class="searching-results__container-analitics">\n                    <h2 class="searching-results__title">Результаты поиска</h2>\n                    <a class="searching-results__analitics" href="analytics.html">Посмотреть аналитику ></a>\n                </div>\n                <div class="searching-results__container" id=\'searching-results\'></div>\n            </div>';e.insertAdjacentHTML("beforeend",t.trim())}static applyButton(e){const t=r.a.getData("cardsArray"),a=r.a.getData("isPagination");if(null!=t&&t.articles.length>3&&a){const a='<button class="searching-results__button">Показать еще</button>';e.insertAdjacentHTML("beforeend",a.trim()),e.querySelector(".searching-results__button").addEventListener("click",a=>{this._pagination(),this.applyNewsCards(),a.target.blur();const s=r.a.getData("pagination");t.articles.length<=s.skip+3?(this.removeButton(e),r.a.setData("isPagination",!1)):r.a.setData("isPagination",!0)})}}static applyIndex(e){const t=r.a.getData("pagination"),a=r.a.getData("cardsArray");if(null!=a&&a.articles.length>0){this.saveRequest(),this.applyHeaderCards(e),this.applyButton(e);const s=a.articles.slice(0,t.page*t.take);n.render(s,document.getElementById("searching-results"))}}static removeButton(e){e.removeChild(e.querySelector(".searching-results__button"))}static applyNewsCards(){const e=r.a.getData("pagination"),t=r.a.getData("cardsArray").articles.slice(e.skip,e.skip+3);n.render(t,document.getElementById("searching-results"))}static toggleDisabledElement(e){e.disabled=!e.disabled}static saveRequest(){const e=r.a.getData("requestText");document.querySelector(".header__input").value=e}static _pagination(){const e=r.a.getData("pagination");e.page+=1,e.skip=(e.page-1)*e.take,r.a.setData("pagination",e)}}var c=a(2);var o=document.querySelector(".header__input"),l=new class{constructor(e){this.input=e}isValid(){const e=[];if(0==this.input.validity.valid)return this.input.value.length<2&&e.push("Минимальное количество символов - 2"),this.input.value.length>30&&e.push("setCustomValidity"),0==this.input.value.length&&e.push("Нужно ввести ключевое слово"),e.length>0?(e.forEach(e=>this.input.setCustomValidity(`${e}. \n`)),!1):(this.input.setCustomValidity(""),!0)}}(o),u=new class{constructor(){this.searchBox=document.querySelector(".search-box")}getNews(e){e.preventDefault();const t=e.target.elements.text.value,a={apiKey:c.a,dateFrom:s.a.setDate(-7).toJSON(),dateTo:(new Date).toJSON(),pageSize:100,requestText:t};i.applyLoader(this.searchBox),i.toggleDisabledElement(e.target.elements.text),i.toggleDisabledElement(e.target.elements.submit),class{constructor(){}static getNews(e){return new Promise((t,a)=>{fetch(this._createRequestURL(e)).then(e=>e.ok?e.json():Promise.reject(e)).then(e=>{t(e)}).catch(e=>a(e))})}static _createRequestURL(e){return`https://newsapi.org/v2/everything?q=${e.requestText}&language=ru&from=${e.dateFrom}&to=${e.dateTo}&pageSize=${e.pageSize}&apiKey=${e.apiKey}`}}.getNews(a).then(a=>{s.a.removeChild(this.searchBox),r.a.deleteData("cardsArray"),r.a.deleteData("requestText"),0==a.articles.length?i.applyBadResult(this.searchBox,"Ничего не найдено","К сожалению по вашему запросу ничего не найдено."):(r.a.setData("cardsArray",a),r.a.setData("pagination",{page:1,take:3,skip:0}),r.a.setData("requestText",t),a.articles.length>3?r.a.setData("isPagination",!0):r.a.setData("isPagination",!1),i.applyHeaderCards(this.searchBox),i.applyButton(this.searchBox),i.applyNewsCards()),i.toggleDisabledElement(e.target.elements.text),i.toggleDisabledElement(e.target.elements.submit)}).catch(t=>{console.log(t),i.applyBadResult(this.searchBox,"Ошибка","Во время запроса произошла ошибка. Подождите немного и попробуйте ещё раз"),i.toggleDisabledElement(e.target.elements.text),i.toggleDisabledElement(e.target.elements.submit)})}};o.addEventListener("focus",(function(){return l.isValid()})),o.addEventListener("input",(function(){return l.isValid()})),i.applyIndex(document.querySelector(".search-box")),document.querySelector(".header__container-search-string").addEventListener("submit",(function(e){return u.getNews(e)}))}]);